@page "/operations/label-designer"
@model Algora.Web.Pages.Operations.LabelDesigner.IndexModel
@{
    ViewData["Title"] = "Label Designer";
}

<style>
    /* Label Designer Custom Styles */
    .field-card {
        transition: all 0.2s ease;
        border: 2px solid transparent;
    }
    .field-card:hover {
        border-color: #a855f7;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(168, 85, 247, 0.15);
    }
    .field-card.dragging {
        opacity: 0.5;
        transform: scale(0.95);
    }

    .canvas-wrapper {
        background: linear-gradient(45deg, #f1f5f9 25%, transparent 25%),
                    linear-gradient(-45deg, #f1f5f9 25%, transparent 25%),
                    linear-gradient(45deg, transparent 75%, #f1f5f9 75%),
                    linear-gradient(-45deg, transparent 75%, #f1f5f9 75%);
        background-size: 20px 20px;
        background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
    }

    .label-canvas {
        box-shadow: 0 8px 32px rgba(0,0,0,0.12);
        transition: all 0.3s ease;
    }
    .label-canvas.drop-active {
        box-shadow: 0 0 0 3px #a855f7, 0 8px 32px rgba(168, 85, 247, 0.3);
    }

    .canvas-field {
        transition: box-shadow 0.15s ease, border-color 0.15s ease;
    }
    .canvas-field:hover {
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .canvas-field.selected {
        border-color: #a855f7 !important;
        box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.3);
    }

    .resize-handle {
        width: 10px;
        height: 10px;
        background: #a855f7;
        border: 2px solid white;
        border-radius: 2px;
        position: absolute;
        bottom: -5px;
        right: -5px;
        cursor: se-resize;
        opacity: 0;
        transition: opacity 0.15s ease;
    }
    .canvas-field:hover .resize-handle,
    .canvas-field.selected .resize-handle {
        opacity: 1;
    }

    .prop-section {
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 1rem;
        margin-bottom: 1rem;
    }
    .prop-section:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }

    .style-btn {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        background: white;
        transition: all 0.15s ease;
    }
    .style-btn:hover {
        background: #f8fafc;
        border-color: #cbd5e1;
    }
    .style-btn.active {
        background: #faf5ff;
        border-color: #a855f7;
        color: #a855f7;
    }

    .size-preset {
        padding: 0.5rem 0.75rem;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        background: white;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.15s ease;
    }
    .size-preset:hover {
        border-color: #a855f7;
        background: #faf5ff;
    }
    .size-preset.active {
        border-color: #a855f7;
        background: #a855f7;
        color: white;
    }

    .product-row {
        transition: background 0.15s ease;
    }
    .product-row:hover {
        background: #f8fafc;
    }

    .step-indicator {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 0.875rem;
    }
</style>

<div class="w-full px-6 py-6 mx-auto">
    <!-- Header -->
    <div class="flex flex-wrap items-center justify-between mb-6">
        <div>
            <h4 class="mb-1 font-bold text-xl dark:text-white">
                <i class="fas fa-tags text-purple-500 mr-2"></i>Label Designer
            </h4>
            <p class="text-sm text-slate-500 dark:text-slate-400">
                Create custom product labels with drag-and-drop simplicity
            </p>
        </div>
        <div class="flex gap-3">
            <button id="clearCanvasBtn" class="inline-flex items-center px-4 py-2.5 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-all dark:bg-gray-800 dark:border-gray-700 dark:text-white">
                <i class="fas fa-eraser mr-2 text-slate-400"></i> Clear
            </button>
            <button id="printLabelsBtn" class="inline-flex items-center px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-pink-500 rounded-xl shadow-lg shadow-purple-500/25 hover:shadow-purple-500/40 hover:scale-[1.02] transition-all">
                <i class="fas fa-print mr-2"></i> Print Labels
            </button>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="grid grid-cols-12 gap-6">

        <!-- Left Sidebar - Fields & Templates -->
        <div class="col-span-12 lg:col-span-3 space-y-5">

            <!-- Template Card -->
            <div class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 overflow-hidden dark:bg-gray-950 dark:shadow-none">
                <div class="bg-gradient-to-r from-purple-600 to-pink-500 px-5 py-4">
                    <h6 class="text-white font-semibold flex items-center">
                        <i class="fas fa-file-alt mr-2"></i> Template
                    </h6>
                </div>
                <div class="p-5 space-y-4">
                    <div>
                        <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-2">Load Template</label>
                        <select id="templateSelector" class="w-full px-4 py-2.5 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white">
                            <option value="">+ New Template</option>
                            @foreach (var template in Model.Templates)
                            {
                                <option value="@template.Id">
                                    @template.Name @(template.IsDefault ? "‚òÖ" : "")
                                </option>
                            }
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-2">Template Name</label>
                        <input type="text" id="templateName" placeholder="My Label Template"
                               class="w-full px-4 py-2.5 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white" />
                    </div>
                    <div class="flex gap-2">
                        <button id="saveTemplateBtn" class="flex-1 px-4 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-pink-500 rounded-xl hover:shadow-lg transition-all">
                            <i class="fas fa-save mr-1"></i> Save
                        </button>
                        <button id="deleteTemplateBtn" class="px-4 py-2.5 text-sm font-medium text-red-600 bg-red-50 rounded-xl hover:bg-red-100 transition-all dark:bg-red-900/20 dark:text-red-400">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Label Size Card -->
            <div class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 overflow-hidden dark:bg-gray-950 dark:shadow-none">
                <div class="px-5 py-4 border-b border-slate-100 dark:border-gray-800">
                    <h6 class="font-semibold text-slate-800 dark:text-white flex items-center">
                        <i class="fas fa-ruler-combined text-purple-500 mr-2"></i> Label Size
                    </h6>
                </div>
                <div class="p-5">
                    <div class="grid grid-cols-2 gap-2 mb-4">
                        @foreach (var preset in Model.AveryPresets.Take(4))
                        {
                            <button class="size-preset" data-type="@preset.Type" data-width="@preset.WidthInches" data-height="@preset.HeightInches">
                                @preset.Name
                            </button>
                        }
                    </div>
                    <select id="labelType" class="w-full px-4 py-2.5 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white mb-3">
                        <optgroup label="üìÑ Avery Labels (Sheet)">
                            @foreach (var preset in Model.AveryPresets)
                            {
                                <option value="@preset.Type" data-width="@preset.WidthInches" data-height="@preset.HeightInches">
                                    @preset.Name
                                </option>
                            }
                        </optgroup>
                        <optgroup label="üî• Thermal Labels (Roll)">
                            @foreach (var preset in Model.ThermalPresets)
                            {
                                <option value="@preset.Type" data-width="@preset.WidthInches" data-height="@preset.HeightInches">
                                    @preset.Name
                                </option>
                            }
                        </optgroup>
                        <option value="Custom">üìê Custom Size...</option>
                    </select>
                    <div id="customSizeInputs" class="hidden grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-xs text-slate-500 mb-1">Width (inches)</label>
                            <input type="number" id="customWidth" step="0.125" min="0.5" max="10" value="2"
                                   class="w-full px-3 py-2 text-sm bg-slate-50 border-0 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white" />
                        </div>
                        <div>
                            <label class="block text-xs text-slate-500 mb-1">Height (inches)</label>
                            <input type="number" id="customHeight" step="0.125" min="0.5" max="10" value="1"
                                   class="w-full px-3 py-2 text-sm bg-slate-50 border-0 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Available Fields Card -->
            <div class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 overflow-hidden dark:bg-gray-950 dark:shadow-none">
                <div class="px-5 py-4 border-b border-slate-100 dark:border-gray-800">
                    <h6 class="font-semibold text-slate-800 dark:text-white flex items-center">
                        <i class="fas fa-th-large text-purple-500 mr-2"></i> Available Fields
                    </h6>
                    <p class="text-xs text-slate-400 mt-1">Drag fields onto the canvas</p>
                </div>
                <div id="fieldPalette" class="p-4 grid grid-cols-2 gap-2 max-h-[400px] overflow-y-auto">
                    @{
                        var fieldIcons = new Dictionary<string, (string icon, string color)>
                        {
                            {"ProductTitle", ("fa-heading", "text-blue-500 bg-blue-50")},
                            {"SKU", ("fa-hashtag", "text-green-500 bg-green-50")},
                            {"Barcode", ("fa-barcode", "text-purple-500 bg-purple-50")},
                            {"Price", ("fa-dollar-sign", "text-emerald-500 bg-emerald-50")},
                            {"CompareAtPrice", ("fa-tag", "text-orange-500 bg-orange-50")},
                            {"VariantTitle", ("fa-layer-group", "text-cyan-500 bg-cyan-50")},
                            {"VariantOption1", ("fa-1", "text-indigo-500 bg-indigo-50")},
                            {"VariantOption2", ("fa-2", "text-indigo-500 bg-indigo-50")},
                            {"VariantOption3", ("fa-3", "text-indigo-500 bg-indigo-50")},
                            {"Vendor", ("fa-building", "text-slate-500 bg-slate-100")},
                            {"ProductType", ("fa-boxes-stacked", "text-amber-500 bg-amber-50")},
                            {"Weight", ("fa-weight-hanging", "text-rose-500 bg-rose-50")},
                            {"InventoryQuantity", ("fa-cubes", "text-teal-500 bg-teal-50")},
                            {"CustomText", ("fa-font", "text-pink-500 bg-pink-50")}
                        };
                    }
                    @foreach (var field in Model.AvailableFields)
                    {
                        var iconInfo = fieldIcons.GetValueOrDefault(field.FieldType, ("fa-square", "text-gray-500 bg-gray-50"));
                        <div class="field-card draggable-source p-3 bg-white rounded-xl cursor-grab active:cursor-grabbing border-2 border-slate-100 dark:bg-gray-900 dark:border-gray-800"
                             data-field-type="@field.FieldType" title="@field.Description">
                            <div class="@iconInfo.color w-8 h-8 rounded-lg flex items-center justify-center mb-2">
                                <i class="fas @iconInfo.icon text-sm"></i>
                            </div>
                            <span class="text-xs font-medium text-slate-700 dark:text-slate-300 leading-tight block">@field.DisplayName</span>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Center - Canvas Area -->
        <div class="col-span-12 lg:col-span-6">
            <div class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 overflow-hidden dark:bg-gray-950 dark:shadow-none h-full">
                <div class="px-5 py-4 border-b border-slate-100 dark:border-gray-800 flex justify-between items-center">
                    <div>
                        <h6 class="font-semibold text-slate-800 dark:text-white flex items-center">
                            <i class="fas fa-vector-square text-purple-500 mr-2"></i> Label Canvas
                        </h6>
                        <p class="text-xs text-slate-400 mt-0.5">Drag, resize, and position your fields</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <span id="canvasSize" class="px-3 py-1.5 bg-slate-100 rounded-lg text-xs font-mono text-slate-600 dark:bg-gray-800 dark:text-slate-400">
                            2.625" √ó 1"
                        </span>
                    </div>
                </div>

                <div id="canvasContainer" class="canvas-wrapper p-8 min-h-[450px] flex items-center justify-center">
                    <div id="labelCanvas" class="label-canvas bg-white rounded-lg relative overflow-hidden" style="width: 252px; height: 96px;">
                        <div id="canvasPlaceholder" class="absolute inset-0 flex flex-col items-center justify-center text-slate-300 pointer-events-none">
                            <i class="fas fa-mouse-pointer text-3xl mb-2"></i>
                            <span class="text-sm font-medium">Drop fields here</span>
                        </div>
                    </div>
                </div>

                <!-- Preview Product Selector -->
                <div class="px-5 py-4 border-t border-slate-100 dark:border-gray-800 bg-slate-50 dark:bg-gray-900">
                    <div class="flex items-center gap-3">
                        <div class="flex-1">
                            <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-1.5">
                                <i class="fas fa-eye mr-1"></i> Preview with Product
                            </label>
                            <select id="previewProduct" class="w-full px-4 py-2.5 text-sm bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-700 dark:text-white">
                                <option value="">Select a product to preview...</option>
                                @foreach (var product in Model.Products)
                                {
                                    var displayName = string.IsNullOrEmpty(product.VariantTitle) || product.VariantTitle == "Default Title"
                                        ? product.ProductTitle
                                        : $"{product.ProductTitle} - {product.VariantTitle}";
                                    <option value="@product.ProductId-@product.VariantId">@displayName</option>
                                }
                            </select>
                        </div>
                        <button id="refreshPreview" class="mt-5 px-4 py-2.5 text-slate-600 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-all dark:bg-gray-800 dark:border-gray-700 dark:text-white" title="Refresh Preview">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar - Properties -->
        <div class="col-span-12 lg:col-span-3">
            <div id="fieldProperties" class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 overflow-hidden dark:bg-gray-950 dark:shadow-none sticky top-6">
                <div class="px-5 py-4 border-b border-slate-100 dark:border-gray-800">
                    <h6 class="font-semibold text-slate-800 dark:text-white flex items-center">
                        <i class="fas fa-sliders-h text-purple-500 mr-2"></i> Field Properties
                    </h6>
                </div>

                <!-- No Field Selected State -->
                <div id="noFieldSelected" class="p-8 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-slate-100 dark:bg-gray-800 flex items-center justify-center">
                        <i class="fas fa-hand-pointer text-2xl text-slate-300 dark:text-slate-600"></i>
                    </div>
                    <p class="text-sm font-medium text-slate-500 dark:text-slate-400 mb-1">No field selected</p>
                    <p class="text-xs text-slate-400 dark:text-slate-500">Click a field on the canvas to edit its properties</p>
                </div>

                <!-- Field Properties Form -->
                <div id="fieldPropertiesForm" class="hidden p-5">
                    <!-- Field Type Badge -->
                    <div class="prop-section">
                        <div class="flex items-center justify-between">
                            <span class="text-xs font-semibold text-slate-500 uppercase tracking-wide">Editing</span>
                            <span id="selectedFieldType" class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold dark:bg-purple-900/30 dark:text-purple-400"></span>
                        </div>
                    </div>

                    <!-- Typography -->
                    <div class="prop-section">
                        <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-3">
                            <i class="fas fa-font mr-1 text-slate-400"></i> Typography
                        </label>
                        <select id="fontFamily" class="w-full px-4 py-2.5 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white mb-3">
                            <option value="Arial">Arial</option>
                            <option value="Helvetica">Helvetica</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Verdana">Verdana</option>
                            <option value="Courier New">Courier New</option>
                        </select>
                        <div class="flex items-center gap-2">
                            <input type="number" id="fontSize" min="6" max="72" value="10"
                                   class="w-20 px-3 py-2.5 text-sm text-center bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white" />
                            <span class="text-xs text-slate-400">pt</span>
                        </div>
                    </div>

                    <!-- Style Buttons -->
                    <div class="prop-section">
                        <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-3">
                            <i class="fas fa-palette mr-1 text-slate-400"></i> Style
                        </label>
                        <div class="flex gap-2 mb-3">
                            <button id="toggleBold" class="style-btn dark:bg-gray-900 dark:border-gray-700" title="Bold">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button id="toggleItalic" class="style-btn dark:bg-gray-900 dark:border-gray-700" title="Italic">
                                <i class="fas fa-italic"></i>
                            </button>
                            <div class="w-px bg-slate-200 dark:bg-gray-700 mx-1"></div>
                            <button id="alignLeft" class="style-btn dark:bg-gray-900 dark:border-gray-700" title="Align Left">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button id="alignCenter" class="style-btn dark:bg-gray-900 dark:border-gray-700" title="Align Center">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button id="alignRight" class="style-btn dark:bg-gray-900 dark:border-gray-700" title="Align Right">
                                <i class="fas fa-align-right"></i>
                            </button>
                        </div>
                        <div class="flex items-center gap-3">
                            <label class="text-xs text-slate-500">Color</label>
                            <div class="relative flex-1">
                                <input type="color" id="textColor" value="#000000"
                                       class="w-full h-10 rounded-xl cursor-pointer border-0 p-1" />
                            </div>
                        </div>
                    </div>

                    <!-- Custom Text (conditional) -->
                    <div id="customTextContainer" class="hidden prop-section">
                        <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-2">
                            <i class="fas fa-edit mr-1 text-slate-400"></i> Custom Text
                        </label>
                        <textarea id="customText" rows="2" placeholder="Enter your text..."
                                  class="w-full px-4 py-3 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white resize-none"></textarea>
                    </div>

                    <!-- Barcode Format (conditional) -->
                    <div id="barcodeFormatContainer" class="hidden prop-section">
                        <label class="block text-xs font-semibold text-slate-600 dark:text-slate-400 mb-2">
                            <i class="fas fa-barcode mr-1 text-slate-400"></i> Barcode Format
                        </label>
                        <select id="barcodeFormat" class="w-full px-4 py-2.5 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white">
                            <option value="Code128">Code 128 (Recommended)</option>
                            <option value="EAN13">EAN-13</option>
                            <option value="EAN8">EAN-8</option>
                            <option value="UPCA">UPC-A</option>
                            <option value="QRCode">QR Code</option>
                            <option value="Code39">Code 39</option>
                        </select>
                    </div>

                    <!-- Remove Button -->
                    <button id="removeField" class="w-full px-4 py-3 text-sm font-semibold text-red-600 bg-red-50 rounded-xl hover:bg-red-100 transition-all flex items-center justify-center gap-2 dark:bg-red-900/20 dark:text-red-400">
                        <i class="fas fa-trash-alt"></i> Remove Field
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Print Labels Modal -->
<div id="printModal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-950 rounded-3xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden animate-in fade-in zoom-in duration-200">
        <!-- Modal Header -->
        <div class="px-6 py-5 border-b border-slate-100 dark:border-gray-800 flex items-center justify-between">
            <div>
                <h5 class="text-lg font-bold text-slate-800 dark:text-white flex items-center">
                    <i class="fas fa-print text-purple-500 mr-3"></i> Print Labels
                </h5>
                <p class="text-sm text-slate-500 mt-0.5">Generate PDF labels for your products</p>
            </div>
            <button id="closePrintModal" class="w-10 h-10 rounded-xl bg-slate-100 dark:bg-gray-800 flex items-center justify-center text-slate-400 hover:text-slate-600 hover:bg-slate-200 transition-all">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Modal Body -->
        <div class="p-6 overflow-y-auto max-h-[60vh]">
            <!-- Step 1: Select Template -->
            <div class="mb-6">
                <div class="flex items-center gap-3 mb-3">
                    <div class="step-indicator bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400">1</div>
                    <label class="text-sm font-semibold text-slate-700 dark:text-slate-300">Select Template</label>
                </div>
                <select id="printTemplateSelector" class="w-full px-4 py-3 text-sm bg-slate-50 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:bg-gray-900 dark:text-white">
                    @if (!Model.Templates.Any())
                    {
                        <option value="">No templates available - create one first</option>
                    }
                    @foreach (var template in Model.Templates)
                    {
                        <option value="@template.Id">@template.Name (@template.LabelType)</option>
                    }
                </select>
            </div>

            <!-- Step 2: Select Products -->
            <div>
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                        <div class="step-indicator bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400">2</div>
                        <label class="text-sm font-semibold text-slate-700 dark:text-slate-300">Select Products</label>
                    </div>
                    <label class="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400 cursor-pointer">
                        <input type="checkbox" id="selectAllProducts" class="w-4 h-4 rounded border-slate-300 text-purple-600 focus:ring-purple-500" />
                        Select All
                    </label>
                </div>
                <div class="border border-slate-200 dark:border-gray-700 rounded-2xl overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-slate-50 dark:bg-gray-900">
                            <tr>
                                <th class="w-12 p-3"></th>
                                <th class="p-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wide">Product</th>
                                <th class="p-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wide">SKU</th>
                                <th class="p-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wide w-24">Copies</th>
                            </tr>
                        </thead>
                        <tbody id="printProductList" class="divide-y divide-slate-100 dark:divide-gray-800">
                            @foreach (var product in Model.Products)
                            {
                                var displayName = string.IsNullOrEmpty(product.VariantTitle) || product.VariantTitle == "Default Title"
                                    ? product.ProductTitle
                                    : $"{product.ProductTitle} - {product.VariantTitle}";
                                <tr class="product-row">
                                    <td class="p-3 text-center">
                                        <input type="checkbox" class="product-checkbox w-4 h-4 rounded border-slate-300 text-purple-600 focus:ring-purple-500"
                                               data-product-id="@product.ProductId"
                                               data-variant-id="@product.VariantId" />
                                    </td>
                                    <td class="p-3">
                                        <span class="text-sm font-medium text-slate-800 dark:text-white">@displayName</span>
                                    </td>
                                    <td class="p-3">
                                        <span class="text-sm font-mono text-slate-500">@(product.SKU ?? "‚Äî")</span>
                                    </td>
                                    <td class="p-3">
                                        <input type="number" class="copies-input w-full px-3 py-2 text-sm text-center bg-slate-50 border-0 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-800 dark:text-white"
                                               value="1" min="1" max="999" />
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Modal Footer -->
        <div class="px-6 py-4 border-t border-slate-100 dark:border-gray-800 bg-slate-50 dark:bg-gray-900 flex justify-end gap-3">
            <button id="cancelPrint" class="px-5 py-2.5 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-all dark:bg-gray-800 dark:border-gray-700 dark:text-white">
                Cancel
            </button>
            <button id="generatePdfBtn" class="px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-pink-500 rounded-xl shadow-lg shadow-purple-500/25 hover:shadow-purple-500/40 transition-all flex items-center gap-2">
                <i class="fas fa-file-pdf"></i> Generate PDF
            </button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <script src="~/js/label-designer.js" asp-append-version="true"></script>
}
